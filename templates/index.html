<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Stock Prediction Dashboard ‚Äî Bloomberg-style ML-powered market forecasting using Prophet, ARIMA, Linear Regression, LSTM and Ensemble models.">
  <title>StockAI ‚Äî Prediction Dashboard</title>
  <link rel="stylesheet" href="/static/css/style.css">
  <!-- Plotly for charts -->
  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
</head>

<body>

  <div id="toast-container"></div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     APP SHELL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="app-shell">

    <!-- ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <nav class="sidebar" aria-label="Main navigation">
      <div class="sidebar-logo" title="StockAI">üìà</div>
      <div class="sidebar-nav">
        <button class="nav-item active" data-section="dashboard" title="Dashboard" id="nav-dashboard">
          ‚ñ¶
          <span class="tooltip">Dashboard</span>
        </button>
        <button class="nav-item" data-section="csv" title="CSV Upload" id="nav-csv">
          üìÇ
          <span class="tooltip">CSV Upload</span>
        </button>
        <button class="nav-item" data-section="manual" title="Manual Data" id="nav-manual">
          ‚úèÔ∏è
          <span class="tooltip">Manual Data</span>
        </button>
        <button class="nav-item" data-section="watchlist" title="Watchlist" id="nav-watchlist">
          ‚≠ê
          <span class="tooltip">Watchlist</span>
        </button>
      </div>
      <div class="sidebar-bottom">
        <button class="nav-item" onclick="window.open('/status')" title="System Status">
          ‚öô
          <span class="tooltip">System Status</span>
        </button>
      </div>
    </nav>

    <!-- ‚îÄ‚îÄ Navbar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <header class="navbar" role="banner">

      <!-- Ticker Search -->
      <div class="search-wrap">
        <span class="search-icon">üîç</span>
        <input type="text" id="search-input" class="search-input" placeholder="Search ticker‚Ä¶" autocomplete="off"
          spellcheck="false" aria-label="Search ticker symbol">
        <div id="autocomplete-list" class="autocomplete-list" role="listbox"></div>
      </div>

      <!-- Days Slider -->
      <div class="days-group">
        <span class="days-label">Forecast</span>
        <input type="range" id="days-slider" class="days-slider" min="0" max="5" value="1" step="1"
          aria-label="Forecast days">
        <span id="days-value" class="days-value">30d</span>
      </div>

      <!-- Model Selector -->
      <select id="model-select" class="model-select" aria-label="Prediction model">
        <option value="prophet">Prophet</option>
        <option value="linear">Linear Reg.</option>
        <option value="arima">ARIMA</option>
        <option value="lstm">LSTM</option>
        <option value="ensemble">Ensemble ‚ö°</option>
      </select>

      <!-- Predict Button -->
      <button id="btn-predict" class="btn-predict" aria-label="Run prediction">
        <span class="btn-text">‚ö° Predict</span>
        <span class="spinner"><span class="spin">‚Üª</span> Running‚Ä¶</span>
      </button>

      <!-- History -->
      <div style="position:relative">
        <button id="history-btn" class="history-btn" aria-haspopup="true" aria-expanded="false">
          üïê History
        </button>
        <div id="history-dropdown" class="history-dropdown" role="menu">
          <div class="history-header">Recent Searches</div>
          <div class="history-empty">No history yet</div>
        </div>
      </div>

    </header>

    <!-- ‚îÄ‚îÄ Main Content ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <main class="main" role="main">

      <!-- ======== DASHBOARD SECTION ======== -->
      <section id="section-dashboard" class="section active">

        <!-- Demo Banner -->
        <div id="demo-banner" class="demo-banner hidden" role="alert"></div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">

          <!-- Welcome Screen (visible before first prediction) -->
          <div id="welcome" class="welcome">
            <h2>Stock Prediction Dashboard</h2>
            <p>Search for a ticker above or click a suggestion below to run AI-powered price forecasting with multiple
              models.</p>
            <div class="suggestion-grid">
              <div class="suggestion-card" data-ticker="AAPL">
                <div class="s-ticker">AAPL</div>
                <div class="s-name">Apple Inc.</div>
              </div>
              <div class="suggestion-card" data-ticker="GOOGL">
                <div class="s-ticker">GOOGL</div>
                <div class="s-name">Alphabet Inc.</div>
              </div>
              <div class="suggestion-card" data-ticker="MSFT">
                <div class="s-ticker">MSFT</div>
                <div class="s-name">Microsoft Corp.</div>
              </div>
              <div class="suggestion-card" data-ticker="TSLA">
                <div class="s-ticker">TSLA</div>
                <div class="s-name">Tesla Inc.</div>
              </div>
              <div class="suggestion-card" data-ticker="NVDA">
                <div class="s-ticker">NVDA</div>
                <div class="s-name">NVIDIA Corp.</div>
              </div>
              <div class="suggestion-card" data-ticker="BTC-USD">
                <div class="s-ticker">BTC-USD</div>
                <div class="s-name">Bitcoin</div>
              </div>
            </div>
          </div>

          <!-- Panel 1: Main Chart (spans 2 cols) -->
          <div class="panel panel-chart" id="panel-main-chart">
            <div class="panel-header">
              <div class="panel-title">
                <span class="dot"></span>
                <span id="chart-title">Price Chart &amp; Prediction</span>
              </div>
              <div class="panel-actions">
                <div class="chart-toggle" role="group" aria-label="Chart type">
                  <button data-mode="line" class="active" onclick="setChartMode('line')">Line</button>
                  <button data-mode="candlestick" onclick="setChartMode('candlestick')">Candle</button>
                  <button data-mode="ohlc" onclick="setChartMode('ohlc')">OHLC</button>
                </div>
                <button id="btn-watchlist-main" class="btn-watchlist" data-ticker="">‚òÜ Watchlist</button>
                <button class="btn btn-sm" onclick="openModal()">‚õ∂ Expand</button>
              </div>
            </div>
            <div class="panel-body no-pad" style="min-height:340px;position:relative">
              <div class="skeleton-wrap" style="padding:16px;display:none">
                <div class="skeleton skeleton-chart"></div>
              </div>
              <div class="chart-wrap" style="height:340px">
                <div id="main-chart" style="width:100%;height:100%"></div>
              </div>
            </div>
          </div>

          <!-- Panel: Stats Cards (right column, spans 2 rows) -->
          <div class="panel panel-stats" id="panel-stats">
            <div class="panel-header">
              <div class="panel-title"><span class="dot" style="background:var(--accent)"></span> Key Stats</div>
              <div class="panel-actions">
                <button class="btn btn-sm" onclick="downloadCSV()">‚¨á CSV</button>
                <button class="btn btn-sm" onclick="downloadPNG()">üñº PNG</button>
                <button class="btn btn-sm modal-actions" onclick="shareURL()">üîó Share</button>
              </div>
            </div>
            <div class="panel-body">
              <div class="stats-wrap">
                <div class="stats-grid">
                  <!-- Current Price -->
                  <div class="stat-card" id="stat-current">
                    <div class="stat-label">Current Price</div>
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-sub text-muted">Live</div>
                  </div>
                  <!-- Predicted Price -->
                  <div class="stat-card" id="stat-predicted">
                    <div class="stat-label">Predicted Price</div>
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-sub text-muted">End of period</div>
                  </div>
                  <!-- % Change -->
                  <div class="stat-card" id="stat-pct">
                    <div class="stat-label">Expected Change</div>
                    <div class="stat-value">‚Äî</div>
                    <div class="stat-badge">‚Äî</div>
                  </div>
                  <!-- Confidence -->
                  <div class="stat-card" id="stat-conf">
                    <div class="stat-label">Model Confidence</div>
                    <div class="stat-value">‚Äî</div>
                    <div class="confidence-bar">
                      <div class="confidence-fill" style="width:0%"></div>
                    </div>
                  </div>
                  <!-- Model Used -->
                  <div class="stat-card" id="stat-model">
                    <div class="stat-label">Model</div>
                    <div class="stat-value" style="font-size:16px">‚Äî</div>
                    <div class="stat-sub">RMSE: ‚Äî &nbsp; MAE: ‚Äî</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Panel 2: RSI + MACD -->
          <div class="panel" id="panel-indicators">
            <div class="panel-header">
              <div class="panel-title"><span class="dot" style="background:var(--accent3)"></span> Technical Indicators
              </div>
              <div class="panel-actions">
                <span class="pill blue" style="font-size:10px">RSI ¬∑ MACD</span>
              </div>
            </div>
            <div class="panel-body no-pad" style="min-height:280px;position:relative">
              <div class="skeleton-wrap" style="padding:16px;display:none">
                <div class="skeleton skeleton-chart" style="height:260px"></div>
              </div>
              <div class="chart-wrap" style="height:280px">
                <div id="technical-chart" style="width:100%;height:100%"></div>
              </div>
            </div>
          </div>

          <!-- Panel 3: Model Accuracy Comparison -->
          <div class="panel" id="panel-compare">
            <div class="panel-header">
              <div class="panel-title"><span class="dot" style="background:var(--warn)"></span> Model Accuracy (RMSE)
              </div>
              <div class="panel-actions">
                <span class="pill" style="font-size:10px">Lower = Better</span>
              </div>
            </div>
            <div class="panel-body no-pad" style="min-height:240px">
              <div class="chart-wrap" style="height:240px">
                <div id="rmse-chart" style="width:100%;height:100%"></div>
              </div>
            </div>
          </div>

        </div><!-- /dashboard-grid -->
      </section>

      <!-- ======== CSV UPLOAD SECTION ======== -->
      <section id="section-csv" class="section">
        <div class="page-header">
          <div>
            <div class="page-title">üìÇ CSV Upload</div>
            <div class="page-sub">Upload your own historical price data for prediction</div>
          </div>
        </div>

        <!-- Drop zone -->
        <div id="csv-dropzone" class="dropzone">
          <input type="file" id="csv-file-input" accept=".csv" aria-label="Upload CSV file">
          <span class="dropzone-icon">üìä</span>
          <div class="dropzone-text">Drop your CSV file here</div>
          <div class="dropzone-sub">or click to browse &nbsp;¬∑&nbsp; .CSV files only</div>
        </div>

        <!-- Column mapping message (shown if auto-detect fails) -->
        <div id="col-map" class="hidden mt-4"></div>

        <!-- Preview -->
        <div id="csv-preview" class="hidden mt-4">
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title"><span class="dot"></span> File Preview</div>
            </div>
            <div class="panel-body">
              <div id="csv-table-wrap" class="preview-table-wrap"></div>
              <div class="flex gap-2 mt-3">
                <div class="form-group" style="flex:0 0 180px;margin:0">
                  <label class="form-label" for="csv-days">Forecast Days</label>
                  <select id="csv-days" class="form-select">
                    <option value="30">30 days</option>
                    <option value="60">60 days</option>
                    <option value="90">90 days</option>
                    <option value="180">180 days</option>
                  </select>
                </div>
                <div class="form-group" style="flex:0 0 180px;margin:0">
                  <label class="form-label" for="csv-model">Model</label>
                  <select id="csv-model" class="form-select">
                    <option value="prophet">Prophet</option>
                    <option value="linear">Linear Reg.</option>
                    <option value="arima">ARIMA</option>
                    <option value="ensemble">Ensemble</option>
                  </select>
                </div>
                <div style="display:flex;align-items:flex-end">
                  <button id="btn-csv-predict" class="btn btn-primary">‚ö° Run Prediction</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ======== MANUAL DATA SECTION ======== -->
      <section id="section-manual" class="section">
        <div class="page-header">
          <div>
            <div class="page-title">‚úèÔ∏è Manual Data Entry</div>
            <div class="page-sub">Enter or paste your own time-series data</div>
          </div>
          <div class="flex gap-2">
            <button id="btn-paste-clipboard" class="btn">üìã Paste from Clipboard</button>
            <button id="btn-add-row" class="btn">+ Add Row</button>
          </div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
          <!-- Table -->
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title"><span class="dot"></span> Data Table</div>
            </div>
            <div class="panel-body">
              <div class="manual-table-wrap">
                <table class="manual-table">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Price / Value</th>
                      <th></th>
                    </tr>
                  </thead>
                  <tbody id="manual-table-body">
                    <tr>
                      <td><input type="date" class="manual-date"></td>
                      <td><input type="number" step="0.01" class="manual-price" placeholder="0.00"></td>
                      <td></td>
                    </tr>
                    <tr>
                      <td><input type="date" class="manual-date"></td>
                      <td><input type="number" step="0.01" class="manual-price" placeholder="0.00"></td>
                      <td><button class="btn btn-sm btn-danger"
                          onclick="this.closest('tr').remove();updateManualPreview()">‚úï</button></td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="flex gap-2 mt-3">
                <div class="form-group" style="flex:0 0 150px;margin:0">
                  <label class="form-label">Forecast Days</label>
                  <input type="number" id="manual-days" class="form-input" value="30" min="1" max="365">
                </div>
                <div class="form-group" style="flex:0 0 170px;margin:0">
                  <label class="form-label">Model</label>
                  <select id="manual-model" class="form-select">
                    <option value="prophet">Prophet</option>
                    <option value="linear">Linear Reg.</option>
                    <option value="arima">ARIMA</option>
                    <option value="ensemble">Ensemble</option>
                  </select>
                </div>
                <div style="display:flex;align-items:flex-end">
                  <button id="btn-manual-predict" class="btn btn-primary">‚ö° Predict</button>
                </div>
              </div>
            </div>
          </div>
          <!-- Live Preview Chart -->
          <div class="panel">
            <div class="panel-header">
              <div class="panel-title"><span class="dot"></span> Live Preview</div>
            </div>
            <div class="panel-body no-pad" style="height:260px">
              <div id="manual-preview-chart" style="width:100%;height:100%"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- ======== WATCHLIST SECTION ======== -->
      <section id="section-watchlist" class="section">
        <div class="page-header">
          <div>
            <div class="page-title">‚≠ê Watchlist</div>
            <div class="page-sub">Click any ticker to re-run prediction</div>
          </div>
        </div>
        <div class="watchlist-panel">
          <div id="watchlist-container">
            <div class="wl-empty">No tickers in watchlist.<br><small>Click "‚òÜ Watchlist" in the chart panel after a
                prediction.</small></div>
          </div>
        </div>
      </section>

    </main><!-- /main -->
  </div><!-- /app-shell -->

  <!-- ‚îÄ‚îÄ Slide-up Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal-sheet">
      <div class="modal-header">
        <div class="modal-title" id="modal-title">Prediction Chart</div>
        <button class="modal-close" onclick="closeModal()" aria-label="Close">‚úï</button>
      </div>
      <div style="height:400px">
        <div id="modal-chart" style="width:100%;height:100%"></div>
      </div>
      <div class="modal-actions">
        <button class="btn" onclick="downloadPNG()">üñº Download PNG</button>
        <button class="btn" onclick="downloadCSV()">‚¨á Download CSV</button>
        <button class="btn btn-share" onclick="shareURL()">üîó Share URL</button>
      </div>
    </div>
  </div>

  <script src="/static/js/app.js"></script>
</body>

</html>